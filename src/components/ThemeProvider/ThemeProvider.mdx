import { Meta, Props, Story } from '@storybook/addon-docs/blocks';
import ThemeProvider from '.';

<Meta title="Dev | Components / ThemeProvider" component={ThemeProvider} />

# ThemeProvider

`ThemeProvider` является обёрткой вокруг компонента `ThemeProvider` из css in js библиотеки `emotion`, которую использует GDS. Через него на проект прокидывается объект темы проекта и тем самым достигается мультибрендовость: компоненты диктуют API и ожидают увидеть тему.

Кроме того внутри `ThemeProvider` происходит вставка `Global` того же `emotion`, через который определяется глобальный CSS проекта. GDS идёт со встроенными стилями, которые параметризируются через тему, и поддерживает добавление собственных стилей.

Встроенное содержимое:

1. Стили нормализации через [normalize.css](https://necolas.github.io/normalize.css/)
1. Определения шрифтов
1. Базовые стили

## Props

<Props of={ThemeProvider} />

## Использование

`ThemeProvider` является обязательным требованием для обеспечения работы GDS. Оберните приложение в него следующим образом:

```js
<ThemeProvider theme={theme}>
    <App />
</ThemeProvider>
```

Для Storybook это можно сделать через декоратор:

```js
addDecorator(storyFn => <ThemeProvider theme={theme}>{storyFn()}</ThemeProvider>);
```

В качестве темы должен передаваться объект, созданный с помощью хелпера `createTheme`:

```js
const theme = createTheme({
    tokens,
    theme: {
        // Project settings
    },
});
```

## Fonts

Вы можете определить шрифты проекта через поле `global.fonts` объекта темы. Из определённой темы создаётся набор правил `@font-face`.

GDS поддерживает обычные и вариативные шрифты. Для подключения обычного шрифта необходимо определить пути до ассета woff2 и woff в качестве фоллбека в соответствующих переменных. Для вариативного шрифта передайте путь до woff2 через переменную `vf`.

Каждое начертание кроме стандартного должно определять параметры `weight` и/или `italic`. Дополнительные параметры, вроде нестандартных параметров вариативных шрифтов можно передать через `css`.

❗️ Для передачи путей рекомендуется использовать `import`.

❗️ При указании вариативного шрифта в дальнейшем он доступен через имя семейста с припиской "VF": `font-family: 'name VF'`.

❗️ У вариативных шрифтов уже хорошая поддержка ([Caniuse](https://caniuse.com/#feat=variable-fonts)), но всё ещё имеет смысл использовать фоллбеки. Это можно сделать через `@supports (font-variation-settings: normal)` - хелпер `typography` это сделает за вас, предоставив обычную версию шрифта, если вы её определили.

❗️ Передавать woff для вариативных шрифтов не имеет смысла, т.к. все браузеры, поддерживающие вариативные шрифты, поддерживают woff2.

⏱ Во все правила прописывается `font-display: swap` для избежания FOIT.

Формат темы:

```js
interface IGlobalFontsTheme {
    /** Список семейств шрифтов */
    [fontFamily: string]: IGlobalFontFamilyRules[];
}

interface IGlobalFontFamilyRules {
    /** Путь до ассета шрифта (формат woff2) */
    woff2?: string;
    /** Путь до ассета шрифта (формат woff) */
    woff?: string;
    /** Путь до ассета шрифта (формат woff2) */
    vf?: string;
    /** Толщина шрифта */
    weight?: number | string;
    /** Курсивное начертание */
    italic?: boolean;
    /** Кастомный CSS */
    css?: Object;
}
```

## Base
