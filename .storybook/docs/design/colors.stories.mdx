import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Design / Colors" />

# Colors

✨ Tokens: `Palettes`, `Colors`

## Составление палитр

Между отделами Frontend и UX заключено ~~перемирие~~ соглашение, которое упрощает жизнь и делает осознанным выбор цвета на проекте. Дизайнеры получают рабочую систему подбора палитр, а фронтендеры — менее «50-ти оттенков серого». Вместе мы ускоряем рабочий процесс и поддерживаем порядок в проекте.

В большинстве проектов за последние годы клиенты приходят к нам со своими цветами в логотипе или брендбуке. Наша задача: не трогать основные цвета и построить палитру оттенков.

Предлагаемые в этом гайде варианты — не панацея. Вы можете построить палитру по своему усмотрению, только проследите, чтобы главные цвета от клиента остались неизменными.

### Цветовая модель HSL (HSLA)

**HSL** — цветовая модель, в основе которой лежат три параметра: **Hue** (оттенок), **Saturation** (Насыщенность) и **Lightness** (Светлота).

Частный случай HSL — включение в палитру четвертого параметра: альфа-канала для прозрачности. В этом случае правильней называть систему **HSLA**. Мы строим палитру в HSL, а HSLA используем, только когда необходима прозрачность для цвета.

<img src="images/colors/figma-hsl.png" alt="Панель выбора цвета в Figma в формате HSL" width="250" />

_Панель выбора цвета в Figma в формате HSL_

### Автоматизированный процесс построения палитры

Инструмент [ColorBox](https://www.colorbox.io/) от Lyft Design - гибкий и интуитивно понятный инструмент для создания цветовых палитр с автоматической проверкой цветового контраста.

<img src="images/colors/ColorBox.jpg" alt="Интерфейс ColorBox" />

_Интерфейс ColorBox_

Для примера мы возьмем синий цвет и будем строить для него палитру:

**HEX**: #005BAD

**HSL**: 208, 100, 34

<img src="images/colors/basic-color.png" alt="Начальный цвет" width="200" />

_Начальный цвет_

Определимся с количеством шагов и выставим нужное нам: 10 будет достаточно.

<img src="images/colors/major-steps.png" alt="Параметр Major steps" width="300" />

_Параметр Major steps_

В настройках Hue прописывается оттенок. По модели HSL параметр нашего оттенка 208. Ставим эти значения на Start и End для создания палитры в нашем оттенке.

Можно задать диапазон для изменения оттенка в соседние цвета на протяжении палитры. Это сделает палитру неравномерной по цвету, но может подтолкнуть к интересной идее.

<img src="images/colors/hue.png" alt="Параметр Hue" width="300" />

_Параметр Hue_

Saturation регулирует насыщенность в палитре.

<img src="images/colors/saturation.png" alt="Параметр Saturation" width="300" />

_Параметр Saturation_

Brightness устанавливает яркость палитры.

<img src="images/colors/brightness.png" alt="Параметр Brightness" width="300" />

_Параметр Brightness_

Не забудьте зафиксировать цвет, который дал клиент. Эта настройка находится внизу и делает обязательным наличие исходного цвета в палитре.

<img src="images/colors/lock-color.png" alt="Параметр Lock Color" width="300" />

_Параметр Lock Color_

На выходе получаем палитру с 10 цветами. На каждом цвете обозначен контраст для черного и белого текста и дан hex-код. Начальный цвет сохранен в палитре и остался неизменным.

<img src="images/colors/palette.png" alt="Итоговая палитра из ColorBox" width="250" />

_Итоговая палитра из ColorBox_

### Как самостоятельно построить палитру основных цветов

Рассмотрим «ручной» метод в качестве альтернативы.

Возьмём всё тот же синий цвет в качестве базового (208, 100, 34) и построим палитру из 10 цветов. Будем использовать для этого плагин **Color Designer** для Figma.

Параметр **L** у нашего цвета равен 34 из 100. Значит в палитре по светлости он будет третьим. Нужно сделать 7 цветов в сторону светлых оттенков и 2 в сторону темных.

Подберём светлые оттенки.

<img src="images/colors/color-designer-tints.png" alt="Подбор светлых оттенков через Color Designer" width="600" />

_Подбор светлых оттенков через Color Designer_

Последний цвет в палитре плагина всегда белый. Мы его не берем, нам нужны предыдущие семь. Их мы переносим в
подготовленные прямоугольники.

<img src="images/colors/palette-tints.png" alt="Палитра светлых оттенков" width="250" />

_Палитра светлых оттенков_

И теперь аналогично тёмные оттенки.

<img src="images/colors/color-designer-shades.png" alt="Подбор тёмных оттенков через Color Designer" width="600" />

_Подбор тёмных оттенков через Color Designer_

Последний цвет в этом случае всегда чёрный - его мы тоже не берем. Остальные переносим.

<img src="images/colors/palette-shades.png" alt="Палитра тёмных оттенков" width="250" />

_Палитра тёмных оттенков_

Наконец, скорректируем оттенки по насыщенности — этим управляет параметр **S**.

**Простое правило:** чем темнее цвет, тем больше насыщенность и наоборот. Не забывайте про глаз - его не заменит набор правил.

После корректировки получаем цветовую палитру из 10 оттенков. При этом главное условие выполнено: цвет, который пришел
от клиента, остался неизменным.

<img src="images/colors/palette-final.png" alt="Итоговая палитра через Color Designer" width="250" />

_Итоговая палитра через Color Designer_

### Проверка цветового контраста

♿️ Нам важно соблюсти минимальные требования по цветовому контрасту, диктуемые [спецификацией WCAG (Level AA)](https://www.w3.org/TR/WCAG21/#contrast-minimum): **коэффициент 4.5 для обычного текста и 3 для крупного** (обычное начертание >= 18px или жирное >= 14px).

Контраст проверяет дизайнер в процессе подбора палитр и фронтенд-разработчик в процессе реализации. Общей рекомендацией является проверка дизайнером основных цветовых пар и автоматизированная проверка результата на фронтенде.

Для дизайнера:

- **ColorBox** выводит значения контраста для чёрного и белого текста на всех цветах сгенерированной палитры.
- Плагин **А11y Color Contrast Checker** для проверки нужных пар на уровне Figma. Он применяется к фрейму и проверяет все тексты на нем.
- Множество онлайн-инструментов. Например, [WebAIM: Contrast Checker](https://webaim.org/resources/contrastchecker/) или [Color Contrast Checker](https://marijohannessen.github.io/color-contrast-checker/).

Для разработчика:

- [Storybook A11y Addon](https://www.npmjs.com/package/@storybook/addon-a11y) - встраивается в качестве панели в Storybook. Изнутри использует **aXe**. Используется на этапе проектирования статических компонентов.
- [aXe Chrome Extension](https://chrome.google.com/webstore/detail/axe-web-accessibility-tes/lhdoppojpmngadmnindnejefpokejbdd) - встраивает aXe в качестве браузерного расширения. Используется на этапе финальной проверки страниц.

<img src="images/colors/contrast.png" alt="Фреймы для проверки контраста через А11y Color Contrast Checker" />

_Фреймы для проверки контраста через А11y Color Contrast Checker_

## Реализация в Figma

Под цвета выделены фреймы `Palettes` и `Colors`: `Palettes` хранит палитры, во фрейме `Colors` дизайнер определяет переменные проекта, значения которых взяты из палитр.

✨ Система цветов токенизируется: все определённые вами цвета автоматически оказываются у разработчика в виде переменных. Для дизайнера это означает дополнительную строгость: структура фреймов берётся из GDS, и работа с цветам ведётся по определённым правилам, о которых ниже.

⚠️ Сейчас нет возможности применить токенизацию для градиентов, так что они указываются **на отдельном фрейме**, и переносятся фронтендером вручную.

Разберём структуру на примере реализации GDS.

<img src="images/colors/structure-palettes.png" alt="Структура фрейма Palletes" width="400" />

_Структура фрейма Palletes_

Вложенные фреймы `blue` и `red` содержат палитры основных цветов проекта, во фрейме `grey` лежит палитра оттенков серого. Мы добавили по 10 оттенков каждого цвета - такого количества достаточно, чтобы покрыть нужные краевые оттенки.

<img src="images/colors/structure-colors.png" alt="Структура фрейма Colors" width="400" />

_Структура фрейма Colors_

На фрейме `Colors` может быть любое разумное количество цветов. Дизайнер предполагает, где в проекте используется цвет, добавляет фрейм и дает название переменной.

Название переменной пишется текстом на цвете. В слоях ничего не переименовывается.

Цвета группируются визуально по принципу «Нейтральные» и «Функциональные»:

<img src="images/colors/neutrals.png" alt="Нейтральные цвета" />

_Нейтральные цвета_

<img src="images/colors/functional.png" alt="Функциональные цвета" />

_Функциональные цвета_

🏆 У цвета есть поле описания. Оно опционально, но его можно заполнить, чтобы предоставить контекст использования переменных другим дизайнерам/разработчикам.

Функциональные цвета можно разбить на группы:

- основные
- функции
- уникальные

**Основные цвета** строятся на основании определённых ранее палитр. Это большинство цветов проекта, всё остальное - это уже исключения.

**Цвета функций** - это error, success и warning. Это всегда красный, зелёный и жёлтый соответственно. Особенность этих переменных в том, что они ассоциируются с определёнными цветами (красный, зелёный и жёлтый), что делает их исключениями - они могут браться не из палитры. Однако если в палитре присутствует оттенок из этих трёх цветов, цвет функции лучше подбирать из палитры.

<img src="images/colors/functions.png" alt="Цвета функций" width="550" />

_Цвета функций_

Единственным обязательным цветом является error, т.к. на всех проектах есть валидация, а соответственно сообщения об ошибках. Это справедливо даже в тех случаях, когда ошибки не отражены в макетах.

**Уникальные цвета** - это прочие цвета-исключения. Например, разноцветные шильдики, не несущие за собой определённый цвет.

<img src="images/colors/tags.png" alt="Цвета шильдиков" width="650" />

_Цвета шильдиков_

После определения цветов на фреймах они становятся автоматически доступны разработчикам в виде переменных, а дизайнеры выделяют их в стили Figma. В итоге оба отдела общаются на одном языке, а изменение дизайнером стиля приводит к мгновенному изменению этого цвета на проекте (после выкачивания токенов).

<img src="images/colors/figma-styles.png" alt="Стили цветов в Figma" width="250" />

_Стили цветов в Figma_

### Нейминг

Задача дизайнера не только подобрать цвета, но и присвоить им переменные. Это делается во фрейме `Colors`. Фрейм `Palettes` разработчик напрямую не использует, так что и переменные там не нужны.

Правила:

- Переменные используют формат [lowerCamelCase](https://ru.wikipedia.org/wiki/CamelCase): первое слово переменной начинается со строчной, каждое последующее — с прописной. Несколько слов пишутся слитно без пробела, дефиса или нижнего подчеркивания.
- Мы не используем транслитерацию — все слова пишутся на английском.

Идеальные имена функциональных переменных не используют в обозначениях названия цветов и не содержат привязки к семантике, т.к. в первом случае название может потерять смысл при изменении значения, а во втором - при добавлении новой функции к тому же цвету.

⛔️ h2Grey

⛔️ paragraphBlue70

⛔️ Black_button

✅ titlePromo

✅ link

✅ dark

Для группы нейтральных цветов всё проще - нейминги строятся на градации тонов (соответствую значениям из палитры).В нейтральных переменных в нейминге нужно придерживаться градации тонов: grey0, grey20, grey40... При этом не стоит выносить сразу все - это создаёт проблему с переизбытком цветов, которую мы как раз пытаемся решить.

Системные цвета `black` и `white` заносятся в нейтральные оттенки всегда и не участвуют в палитрах.

Также в нейтральных цветах могут быть полупрозрачные вариации, построенные на цветах палитры с применённым альфа-каналом. Примером может служить подложка у попапов - переменная `fade` в GDS.

⚠️ Крайне не рекомендуется изменять имена переменных после первого экспорта токенов. Подобное изменение повлечёт за собой необходимость разработчику вручную править все вхождения этих переменных. Если имя всё-таки нуужно изменить, об этом стоит уведомить разработчика.
